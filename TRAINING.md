## RDNet for Image Classification
`backbone/rdnet.py` for detection and segmentation is the exact same file as `rdnet.py` for classification.

### Tested Environment
- python 3.11.5
- pytorch 1.13.1
- timm 0.9.6
- deepspeed 0.12.6 (For flops calculation)

### Training Graphs

We provide the graphs of the training procedure. The graph is generated by the Weights & Biases service. You can check the graph by clicking the link below.

https://api.wandb.ai/links/dhkim0225/822w2zsj

### Train
```
# RDNet-T
torchrun --nproc_per_node=4 train.py --pin-mem --channels-last --config train_configs/rdnet.yaml --drop-path 0.15 --model rdnet_tiny

# RDNet-S
torchrun --nproc_per_node=4 train.py --pin-mem --channels-last --config train_configs/rdnet.yaml --drop-path 0.35 --model rdnet_small

# RDNet-B
torchrun --nproc_per_node=4 train.py --pin-mem --channels-last --config train_configs/rdnet.yaml --drop-path 0.4 --model rdnet_base

# RDNet-L
torchrun --nproc_per_node=4 train.py --pin-mem --channels-last --config train_configs/rdnet.yaml --drop-path 0.5 --model rdnet_large

# RDNet-L 384 Finetuning
torchrun --nproc_per_node=4 train.py --pin-mem --channels-last --config train_configs/rdnet_finetune.yaml --model rdnet_large --initial-checkpoint [checkpoint path]
```

### Validation
```
python validate.py --pin-mem --data-dir [Path to ilsvrc2012] --batch-size 64 --channels-last --amp --img-size 224 --model rdnet_tiny --pretrained
python validate.py --pin-mem --data-dir [Path to ilsvrc2012] --batch-size 64 --channels-last --amp --img-size 224 --model rdnet_small --pretrained
python validate.py --pin-mem --data-dir [Path to ilsvrc2012] --batch-size 64 --channels-last --amp --img-size 224 --model rdnet_base --pretrained
python validate.py --pin-mem --data-dir [Path to ilsvrc2012] --batch-size 64 --channels-last --amp --img-size 224 --model rdnet_large --pretrained
```

### Benchmark
```
python benchmark.py -b 128 --num-bench-iter 1000 --img-size=224 --fuser te --channels-last --bench infer -m rdnet_tiny
python benchmark.py -b 128 --num-bench-iter 1000 --img-size=224 --fuser te --channels-last --bench infer -m rdnet_small
python benchmark.py -b 128 --num-bench-iter 1000 --img-size=224 --fuser te --channels-last --bench infer -m rdnet_base
python benchmark.py -b 128 --num-bench-iter 1000 --img-size=224 --fuser te --channels-last --bench infer -m rdnet_large
```